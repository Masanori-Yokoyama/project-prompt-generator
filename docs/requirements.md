# Project Prompt Generator 要求仕様書

## 1. 概要
### 1.1 目的
プロジェクトのソースコードファイルを解析し、AIとの対話に適したプロンプトを自動生成するツールを提供する。

### 1.2 スコープ
- プロジェクトディレクトリ内のファイル収集
- .gitignoreルールの解釈と適用
- 指定されたファイルパターンに基づくファイルのフィルタリング
- プロンプト形式でのファイル内容の整形

## 2. 機能要件
### 2.1 ファイル収集機能
- 指定されたディレクトリを再帰的に走査
- .gitignoreルールに基づくファイルの除外
- 指定されたファイルパターン（拡張子または完全なファイル名）に基づくフィルタリング
- 指定された除外ディレクトリの処理

### 2.2 .gitignore処理
- 複数の.gitignoreファイルの解釈
- ディレクトリ階層に応じた.gitignoreルールの適用
- パターンマッチングの実装

### 2.3 プロンプト生成
- 収集したファイルの内容を整形
- 相対パスを含むファイル情報の付加
- 整形されたテキストの生成

### 2.4 コマンドラインインターフェース
#### 必須オプション
- `--dir`: 検索を開始するベースディレクトリ

#### オプション引数
- `--patterns`: 収集対象のファイルパターン（デフォルト値あり）
- `--exclude-dirs`: 除外するディレクトリリスト
- `--output`: 出力ファイルパス
- `--verbose`: 詳細な出力の有効化

### 2.5 Python API
```python
generator = PromptGenerator(
    base_dir="./path",
    file_patterns=[".py", ".js"],
    exclude_dirs=["node_modules"]
)
files = generator.collect_files()
prompt = generator.generate_prompt(files)
```

## 3. 非機能要件
### 3.1 パフォーマンス
- 大規模プロジェクトでも実用的な応答時間の確保
- メモリ使用量の最適化

### 3.2 信頼性
- ファイル読み取りエラーの適切なハンドリング
- 不正なパターンや入力の処理

### 3.3 保守性
- モジュール化された設計
- 適切なドキュメンテーション
- テストカバレッジの確保

### 3.4 使用性
- 直感的なコマンドライン引数
- 分かりやすいエラーメッセージ
- 詳細なドキュメント

## 4. 制約条件
- Python 3.7以上での動作
- 外部依存はpathspecのみ
- クロスプラットフォーム対応（Windows/Mac/Linux）

## 5. テスト要件
### 5.1 単体テスト
- GitignoreRule クラスのテスト
- GitignoreManager クラスのテスト
- PromptGenerator クラスのテスト

### 5.2 統合テスト
- コマンドライン引数の処理
- ファイル収集からプロンプト生成までの一連の流れ

### 5.3 テストケース
- 様々なファイルパターンでのテスト
- 複数の.gitignoreファイルが存在する場合のテスト
- 大規模ディレクトリでのテスト
- 不正な入力値のテスト

## 6. 配布要件
- GitHubからの直接インストール対応
- pip installでのインストール対応
- 適切なバージョニング
- ChangeLogの管理
